(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{285:function(e,t,n){var content=n(507);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(47).default)("12aaa940",content,!0,{sourceMap:!1})},289:function(e,t,n){var content=n(550);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(47).default)("33f7ade0",content,!0,{sourceMap:!1})},290:function(e,t,n){var content=n(552);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(47).default)("b02f456c",content,!0,{sourceMap:!1})},322:function(e,t,n){"use strict";n.r(t);n(20),n(42),n(26),n(59),n(60),n(48),n(49),n(71),n(29),n(30);var r=n(6),o=n(25),c=n(324),l=n(325),d=n(326),v=(n(327),n(328)),m=n(126),f=n(45),h=n(130);function y(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function j(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?y(Object(source),!0).forEach((function(t){Object(o.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):y(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var O={components:{system:c.default,sensors:l.default,operations:d.default,maps:v.default},mixins:[m.a,h.a],computed:{deviceId:function(){return this.$route.query.id},deviceOrganization:function(){return this.$route.query.organization}},data:function(){return{tabActivo:"system",drawer:!1,group:null,deviceData:null,basicTypes:null,datastreams:null,model:{}}},mounted:function(){console.log("device id: "+this.deviceId),console.log("device org: "+this.deviceOrganization),this.findDevice()},methods:j(j({},Object(f.b)({setTab:"appbar/setTab"})),{},{findDevice:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var data,n,r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$api.newDeviceFinder().findByOrganizationAndId(e.deviceOrganization,e.deviceId,!0);case 2:return data=t.sent,e.model=data.data,console.log(data),console.log(e.models),t.next=8,e.$api.basicTypesSearchBuilder().build().execute();case 8:return n=t.sent,console.log(n),e.basicTypes=n.data,t.next=13,e.$api.datamodelsSearchBuilder().filter({and:[{in:{"datamodels.allowedResourceTypes":["entity.device"]}},{eq:{"datamodels.organizationName":e.deviceOrganization}}]}).build().execute();case 13:r=t.sent,console.log(r),o=[],r.data.datamodels.forEach((function(e){e.categories.forEach((function(e){e.datastreams.forEach((function(e){e.schema&&e.schema.$ref&&(e.schema.$ref=e.schema.$ref.replace("og_basic_types.json","")),o.push(e)}))}))})),console.log(o),e.datastreams=o;case 19:case"end":return t.stop()}}),t)})))()}}),watch:{tab:function(){this.tabActivo=this.tab},tabActivo:function(){this.setTab({tab:this.tabActivo})}}},S=(n(551),n(19)),component=Object(S.a)(O,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{padding:"10px"}},[n("v-tabs-items",{model:{value:e.tabActivo,callback:function(t){e.tabActivo=t},expression:"tabActivo"}},[n("v-tab-item",{attrs:{value:"system"}},[n("system",{attrs:{"basic-types":e.basicTypes,datastreams:e.datastreams,model:e.model}})],1),e._v(" "),n("v-tab-item",{attrs:{value:"sensors"}},[n("sensors",{attrs:{"basic-types":e.basicTypes,datastreams:e.datastreams,model:e.model}})],1),e._v(" "),n("v-tab-item",{attrs:{value:"operations"}},[n("operations",{attrs:{"basic-types":e.basicTypes}})],1),e._v(" "),n("v-tab-item",{attrs:{value:"eventos"}},[n("eventos")],1),e._v(" "),n("v-tab-item",{attrs:{value:"maps"}},[n("maps",{attrs:{model:e.model}})],1)],1)],1)}),[],!1,null,"7de97362",null);t.default=component.exports;installComponents(component,{System:n(324).default,Sensors:n(325).default,Operations:n(326).default,Eventos:n(327).default,Maps:n(328).default})},324:function(e,t,n){"use strict";n.r(t);n(20),n(42),n(26),n(57),n(59),n(60),n(48),n(93),n(29),n(30);var r=n(6),o=n(25),c=n(278),l=(n(276),n(277),n(126));function d(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function v(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?d(Object(source),!0).forEach((function(t){Object(o.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):d(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var m={name:"system",components:{VJsf:c.a},mixins:[l.a],props:{basicTypes:{type:Object,default:function(){return null}},model:{type:Object,default:function(){return null}},datastreams:{type:Array,default:function(){return[]}}},watch:{model:{handler:function(e,t){var n=this;e?(this.finalSystemSchema=[],this.systemDatastreams.forEach((function(element){n.model[element]?(n.innerModel[element]=n.model[element]._value._current.value,n.finalSystemSchema.push(element)):n.model["provision."+element]?(n.innerModel[element]=n.model["provision."+element]._value._current.value,n.finalSystemSchema.push(element)):n.finalSystemSchema.push(element)})),console.log(this.innerModel)):this.innerModel={}},deep:!0}},data:function(){return{valid:!1,disabled:!0,options:{},innerModel:this.model?v({},this.model):{},systemDatastreams:["device.identifier","device.specificType","device.name","device.description","device.serialNumber","device.operationalStatus","device.administrativeState"],finalSystemSchema:[]}},methods:{inputSystem:function(){var e=this;this.systemDatastreams.forEach((function(element){e.model[element]?e.innerModel[element]!=e.model[element]._value._current.value&&(console.log(e.innerModel[element]),e.disabled=!1):e.model["provision."+element]?e.innerModel[element]!=e.model["provision."+element]._value._current.value&&(console.log(e.innerModel[element]),e.disabled=!1):""!=e.innerModel[element]&&(e.disabled=!1)}))},sendInfo:function(){this.sendInfoApi()},sendInfoApi:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,r,o,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(r in t.prev=0,n=e.$api.deviceMessageBuilder().withDataStreamVersion(""+(new Date).getTime()),e.innerModel)console.log(e.model[r]),console.log(e.innerModel[r]),null!=e.innerModel[r]&&(o=e.$api.datapointsBuilder().withValue(e.innerModel[r]),c=e.$api.datastreamBuilder().withId(r),n.withDataStream(c.withDatapoint(o)));return n.withId(e.innerModel["device.identifier"]),t.next=6,n.create();case 6:t.sent,t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.error(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))()}},computed:{systemSchema:function(){var e=this;if(this.basicTypes&&this.datastreams&&this.datastreams.length>0){var t={type:"object",properties:{},definitions:this.basicTypes.definitions};return this.datastreams.forEach((function(n){e.finalSystemSchema.includes(n.identifier)&&(t.properties[n.identifier]=n.schema)})),console.log(t),t}return{type:"object",properties:{}}},deviceId:function(){return this.$route.query.id},deviceOrganization:function(){return this.$route.query.organization}}},f=n(19),component=Object(f.a)(m,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-btn",{attrs:{disabled:e.disabled,fab:"",fixed:"",bottom:"",right:"",color:"accent"},on:{click:e.sendInfo}},[n("v-icon",[e._v(" mdi-send ")])],1),e._v(" "),n("v-form",{model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[e.systemSchema?n("v-jsf",{attrs:{schema:e.systemSchema,options:e.options},on:{change:e.inputSystem},model:{value:e.innerModel,callback:function(t){e.innerModel=t},expression:"innerModel"}}):e._e()],1)],1)}),[],!1,null,null,null);t.default=component.exports},325:function(e,t,n){"use strict";n.r(t);n(42),n(26),n(57),n(93),n(29),n(58),n(30);var r=n(6),o=n(278),c=(n(276),n(277),{name:"sensors",mixins:[n(126).a],components:{VJsf:o.a},props:{model:{type:Object,default:function(){return null}},basicTypes:{type:Object,default:function(){return null}},datastreams:{type:Array,default:function(){return[]}}},computed:{deviceId:function(){return this.$route.query.id},arrSensors:function(){return["device.clock","device.cpu.status","device.cpu.total","device.cpu.usage","device.powersupply.battery.charge","device.powersupply.battery.current","device.powersupply.battery.status","device.powersupply.battery.voltage","device.powersupply.outage","device.powersupplname: 'system',sk.total","device.storage.disk.usage","device.storage.ramDisk.total","device.storage.ramDisk.usage","device.temperature.status","device.temperature.value"]},sensorsSchema:function(){var e=this;if(this.basicTypes&&this.datastreams&&this.datastreams.length>0&&this.selectedSensors&&this.selectedSensors.length>0){var t={type:"object",properties:{},definitions:this.basicTypes.definitions};return this.datastreams.filter((function(t){return e.selectedSensors.includes(t.identifier)})).forEach((function(e){t.properties[e.identifier]=e.schema})),console.log(t),t}return{type:"object",properties:{}}}},watch:{model:{handler:function(e,t){this.mapModelInfo(e)},deep:!0}},data:function(){return{autoSendVar:"",contSend:100,switchMe:!1,change:!1,valid:!1,selectedSensors:[],options:{},innerModel:{}}},mounted:function(){this.mapModelInfo(this.model)},destroyed:function(){this.switchMe&&clearInterval(this.autoSendVar)},methods:{autoSend:function(){if(this.contSend&&clearInterval(this.autoSendVar),!0===this.switchMe){var e=1e3*this.contSend;this.autoSendVar=setInterval(this.sendInfo,e)}else clearInterval(this.autoSendVar)},mapModelInfo:function(e){var t=this;this.innerModel={},e&&(this.selectedSensors=[],this.arrSensors.forEach((function(element){e[element]?(t.innerModel[element]=e[element]._value._current.value,t.selectedSensors.push(element)):e["provision."+element]&&(t.innerModel[element]=e["provision."+element]._value._current.value,t.selectedSensors.push(element))})))},sendInfo:function(){this.sendInfoApi()},sendInfoApi:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,r,o,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(r in t.prev=0,n=e.$api.deviceMessageBuilder().withDataStreamVersion(""+(new Date).getTime()),e.innerModel)console.log(e.innerModel[r]),null!=e.innerModel[r]&&(o=e.$api.datapointsBuilder().withValue(e.innerModel[r]),c=e.$api.datastreamBuilder().withId(r),n.withDataStream(c.withDatapoint(o)));return n.withId(e.deviceId),t.next=6,n.create();case 6:t.sent,t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.error(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))()}}}),l=(n(506),n(19)),component=Object(l.a)(c,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-text-field",{attrs:{color:"accent",label:"Envio automatico",dense:"",rounded:"",type:"number",outlined:"","hide-details":""},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.autoSend(t)}},scopedSlots:e._u([{key:"prepend",fn:function(){return[n("v-simple-checkbox",{attrs:{color:"primary"},on:{click:e.autoSend},model:{value:e.switchMe,callback:function(t){e.switchMe=t},expression:"switchMe"}})]},proxy:!0}]),model:{value:e.contSend,callback:function(t){e.contSend=t},expression:"contSend"}}),e._v(" "),n("v-btn",{attrs:{disabled:e.change,fab:"",fixed:"",bottom:"",right:"",color:"accet"},on:{click:e.sendInfo}},[n("v-icon",[e._v(" mdi-send ")])],1),e._v(" "),n("v-form",{ref:"form",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[n("v-autocomplete",{attrs:{multiple:"",items:e.arrSensors,label:"sensors",chips:"","deletable-chips":""},model:{value:e.selectedSensors,callback:function(t){e.selectedSensors=t},expression:"selectedSensors"}}),e._v(" "),e.sensorsSchema?n("v-jsf",{attrs:{schema:e.sensorsSchema,options:e.options},model:{value:e.innerModel,callback:function(t){e.innerModel=t},expression:"innerModel"}}):e._e()],1)],1)}),[],!1,null,"cbb835ea",null);t.default=component.exports},326:function(e,t,n){"use strict";n.r(t);n(26),n(50),n(193),n(16),n(29),n(58);var r=n(90),o=(n(30),n(6)),c=(n(307),n(308)),l=n(508),d=(n(309),n(310),n(311),n(312),n(313),n(278)),v=(n(276),n(277),n(126));window.JSHINT=l.JSHINT;var m={components:{VJsf:d.a,codemirror:c.codemirror},mixins:[v.a],computed:{deviceId:function(){return this.$route.query.id},operationsMap:function(){var e=this;if(!this.availableOperations)return[];if(localStorage.operationsConfig){var t=JSON.parse(localStorage.operationsConfig);return this.availableOperations.map((function(n){var r={text:{name:n,configured:!1,enabled:!1},value:n};return t[e.deviceId]&&t[e.deviceId][n]&&(r.text.configured=!0,!0===t[e.deviceId][n].enabled&&(r.text.enabled=!0)),r}))}return this.availableOperations.map((function(e){return{text:{name:e,configured:!1,enabled:!1},value:e}}))}},mounted:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$api.rawSearchBuilder().from("/catalog/operations").build().execute();case 2:200===(n=t.sent).statusCode&&(o=n.data.operations.map((function(e){return e.name})),e.availableOperations=Object(r.a)(o));case 4:case"end":return t.stop()}}),t)})))()},data:function(){return{valid:!1,availableOperations:null,disabled:!1,snackbar:!1,availableOperationsItems:[],cmOptions:{tabSize:1,styleActiveLine:!0,lineNumbers:!0,line:!0,lint:!0,mode:"javascript",gutters:["CodeMirror-lint-markers"],lineWrapping:!0,theme:"default"},selectedOperation:null,selectedOperationLocal:null,jsonLocal:{},jsonList:{},widgets:[],activePage:null}},methods:{eventChanged:function(e){e&&(localStorage.eventModel?this.jsonModel=JSON.parse(localStorage.eventModel):localStorage.eventModel=JSON.stringify({}),this.jsonModel[this.deviceId]||(this.jsonModel[this.deviceId]={}),this.jsonModel[this.deviceId][e]||(this.jsonModel[this.deviceId][e]={}),this.innerModel=this.jsonModel[this.deviceId][e])},saveModel:function(){localStorage.eventModel=JSON.stringify(this.jsonModel),this.snackbar=!0},linter:function(){var e=this,t=this.$refs.codemirror.codemirror;this.widgets.forEach((function(element){t.removeLineWidget(element)})),this.widgets.splice(0,this.widgets.length);var n="function "+this.selectedOperation+" (operaRequest, operaResponse){\n"+t.getValue()+"\nreturn operaResponse;}";Object(l.JSHINT)(n),console.log(l.JSHINT.errors),l.JSHINT.errors.forEach((function(n){n.id?"(error)"==n.id&&(e.disabled=!0):n.id||(e.disabled=!1);var r=document.createElement("div");r.appendChild(document.createElement("span")).className="lint-error-icon",r.className="lint-error",e.widgets.push(t.addLineWidget(n.line,r,{coverGutter:!1,noHScroll:!0}))})),0==l.JSHINT.errors.length&&(this.disabled=!1);var r=t.getScrollInfo(),o=t.charCoords({line:t.getCursor().line+1,ch:0},"local").top;r.top+r.clientHeight<o&&t.scrollTo(null,o-r.clientHeight+3),""===this.jsonLocal[this.deviceId][this.selectedOperation].code&&(this.disabled=!0)},operationChanged:function(e){var t=this;e?(localStorage.operationsConfig?this.jsonLocal=JSON.parse(localStorage.operationsConfig):localStorage.operationsConfig=JSON.stringify({}),this.jsonLocal[this.deviceId]||(this.jsonLocal[this.deviceId]={}),this.jsonLocal[this.deviceId][e]||(this.jsonLocal[this.deviceId][e]={code:"",enabled:!1}),this.selectedOperationLocal=e):this.selectedOperationLocal=null,setTimeout((function(){t.linter()}),1e3)},saveOperation:function(){localStorage.operationsConfig=JSON.stringify(this.jsonLocal),this.snackbar=!0},deleteOperation:function(){this.code="",localStorage.operationsConfig=JSON.stringify(this.jsonLocal)}}},f=n(19),component=Object(f.a)(m,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-autocomplete",{attrs:{items:e.operationsMap,label:"Operation to configure","item-text":"value"},on:{change:e.operationChanged},scopedSlots:e._u([{key:"item",fn:function(t){var r=t.item,o=t.on;return[n("v-list-item",e._g({},o),[n("v-list-item-title",[e._v("\r\n                        "+e._s(r.text.name)+"\r\n                    ")]),e._v(" "),r.text.configured&&r.text.enabled?n("v-list-item-icon",[n("v-icon",[e._v("mdi-play-circle")]),e._v(" "),n("v-icon",[e._v("mdi-notebook-edit")])],1):r.text.configured?n("v-list-item-icon",[n("v-icon",[e._v("mdi-pause-circle")]),e._v(" "),n("v-icon",[e._v("mdi-notebook-edit")])],1):e._e()],1)]}}]),model:{value:e.selectedOperation,callback:function(t){e.selectedOperation=t},expression:"selectedOperation"}}),e._v(" "),e.jsonLocal&&e.jsonLocal[e.deviceId]&&e.jsonLocal[e.deviceId][e.selectedOperation]?n("div",[n("v-card",[n("v-card-text",[n("p",[e._v("function "+e._s(e.selectedOperation)+"("),n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on,o=t.attrs;return[n("span",e._g(e._b({},"span",o,!1),r),[e._v("\r\n                                    operaRequest\r\n                                ")])]}}],null,!1,283535751)},[e._v(" "),n("span",[n("pre",[e._v("\r\n          operaRequest: {\r\n            operation:{\r\n              request:{\r\n                name,\r\n                id,\r\n                timestamp,\r\n                params\r\n              }\r\n            }\r\n          }")])])]),e._v(",\r\n                        "),n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on,o=t.attrs;return[n("span",e._g(e._b({},"span",o,!1),r),[e._v("\r\n                                    operaResponse\r\n                                ")])]}}],null,!1,973754229)},[e._v(" "),n("span",[n("pre",[e._v("\r\n          operaResponse: {\r\n            operation:{\r\n              response:{\r\n                name,\r\n                id,\r\n                timestamp,\r\n                resultcode,\r\n                resultDescription\r\n              }\r\n            }\r\n          }")])])]),e._v(") {")],1),e._v(" "),n("codemirror",{ref:"codemirror",attrs:{options:e.cmOptions},on:{changes:e.linter,onLoad:e.linter},model:{value:e.jsonLocal[e.deviceId][e.selectedOperation].code,callback:function(t){e.$set(e.jsonLocal[e.deviceId][e.selectedOperation],"code",t)},expression:"jsonLocal[deviceId][selectedOperation].code"}}),e._v(" "),n("p",[n("pre",[e._v("return operaResponse\r\n            }\r\n            ")])])],1)],1),e._v(" "),n("hr"),e._v(" "),n("v-switch",{attrs:{label:"If switch on code above will run when operation executes"},model:{value:e.jsonLocal[e.deviceId][e.selectedOperationLocal].enabled,callback:function(t){e.$set(e.jsonLocal[e.deviceId][e.selectedOperationLocal],"enabled",t)},expression:"jsonLocal[deviceId][selectedOperationLocal].enabled"}}),e._v(" "),n("v-btn",{attrs:{disabled:e.disabled},on:{click:e.saveOperation}},[e._v(" Save ")]),e._v(" "),n("v-btn",{on:{click:e.deleteOperation}},[e._v(" Delete ")])],1):e._e(),e._v(" "),n("v-snackbar",{scopedSlots:e._u([{key:"action",fn:function(t){var r=t.attrs;return[n("v-btn",e._b({attrs:{color:"pink",text:""},on:{click:function(t){e.snackbar=!1}}},"v-btn",r,!1),[e._v("\r\n                    Close\r\n                ")])]}}]),model:{value:e.snackbar,callback:function(t){e.snackbar=t},expression:"snackbar"}},[e._v("\r\n            "+e._s("Operation save with your javascript thank you!")+"\r\n\r\n            ")])],1)}),[],!1,null,"33c3e68a",null);t.default=component.exports},327:function(e,t,n){"use strict";n.r(t);n(26),n(193),n(49),n(96),n(29),n(58);var r=n(25),o=(n(307),n(308)),c=(n(512),n(513),n(309),n(310),n(311),n(312),n(313),n(278)),l=(n(276),n(277),n(126)),d=n(515),v=n.n(d),m={components:{VJsf:c.a,codemirror:o.codemirror},mixins:[l.a],computed:{disabledMirror:function(){return!this.selectedEvent},disabledModel:function(){return!this.selectedEvent},deviceId:function(){return this.$route.query.id},deviceEvents:function(){return this.jsonEvent[this.deviceId]?(console.log(this.jsonEvent[this.deviceId]),Array.isArray(this.jsonEvent[this.deviceId])?this.jsonEvent[this.deviceId]:this.jsonEvent[this.deviceId].split(",")):(this.jsonEvent[this.deviceId]=["birthEvent","endLifeTimeEvent","statusEvent","tamperingEvent","temperatureEvent","batteryEvent"],console.log(this.jsonEvent[this.deviceId]),this.jsonEvent[this.deviceId])}},mounted:function(){localStorage.events?this.jsonEvent=JSON.parse(localStorage.events):localStorage.events=JSON.stringify({})},data:function(){var e;return e={localSchema:{},innerModel:{},modelform:!1,jsonLocal:{},disabled:!1,mirror:!1,logDialog:!1,options:{},valid:!1},Object(r.a)(e,"innerModel",{}),Object(r.a)(e,"snackbar",!1),Object(r.a)(e,"selectedEvent",null),Object(r.a)(e,"jsonModel",{}),Object(r.a)(e,"activePage",null),Object(r.a)(e,"eventTextField",""),Object(r.a)(e,"jsonEvent",{}),Object(r.a)(e,"widgets",[]),Object(r.a)(e,"cmOptions",{tabSize:1,styleActiveLine:!0,lineNumbers:!0,line:!0,lint:!0,mode:"javascript",gutters:["CodeMirror-lint-markers"],lineWrapping:!0,theme:"default"}),e},methods:{mirrorMethod:function(){var e=this;this.mirror?this.mirror=!1:this.mirror||(this.mirror=!0,setTimeout((function(){e.linter()}),1e3))},modelformMethod:function(){this.modelform?this.modelform=!1:this.modelform||(this.modelform=!0)},linter:function(){var e=this;if(this.mirror){var t=this.$refs.codemirror.codemirror;this.widgets.forEach((function(element){t.removeLineWidget(element)})),this.widgets.splice(0,this.widgets.length);var n=t.getValue(),r=(new v.a).compile({$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0}),o=r(n);r.errors.forEach((function(n){e.disabled=!0;var r=document.createElement("div");r.appendChild(document.createElement("span")).className="lint-error-icon",r.className="lint-error",e.widgets.push(t.addLineWidget(0,r,{coverGutter:!1,noHScroll:!0}))})),console.log(r.errors),0==r.errors.length&&(this.disabled=!1);var c=t.getScrollInfo(),l=t.charCoords({line:t.getCursor().line+1,ch:0},"local").top;c.top+c.clientHeight<l&&t.scrollTo(null,l-c.clientHeight+3),"{}"===this.jsonLocal[this.deviceId][this.selectedEvent].code?this.disabled=!0:this.disabled=!1,console.log(o),console.log(r.errors)}},saveSchema:function(){this.mirror=!1,this.localSchema=JSON.parse(this.jsonLocal[this.deviceId][this.selectedEvent].code),localStorage.eventsConfig=JSON.stringify(this.jsonLocal)},saveEvent:function(){Array.isArray(this.jsonEvent[this.deviceId])?this.jsonEvent[this.deviceId].push(this.eventTextField):(this.jsonEvent[this.deviceId]=this.jsonEvent[this.deviceId].split(","),this.jsonEvent[this.deviceId].push(this.eventTextField),console.log(this.eventTextField)),localStorage.events=JSON.stringify(this.jsonEvent),this.eventTextField="",this.logDialog=!1},eventChanged:function(e){var t=this;e&&(localStorage.eventsConfig?this.jsonLocal=JSON.parse(localStorage.eventsConfig):localStorage.eventsConfig=JSON.stringify({}),this.jsonLocal[this.deviceId]||(this.jsonLocal[this.deviceId]={}),this.jsonLocal[this.deviceId][e]||(this.jsonLocal[this.deviceId][e]={code:"{}"}),this.localSchema=JSON.parse(this.jsonLocal[this.deviceId][e].code)),localStorage.eventModel?this.jsonModel=JSON.parse(localStorage.eventModel):localStorage.eventModel=JSON.stringify({}),this.jsonModel[this.deviceId]||(this.jsonModel[this.deviceId]={}),this.jsonModel[this.deviceId][e]||(this.jsonModel[this.deviceId][e]={}),this.innerModel=this.jsonModel[this.deviceId][e],setTimeout((function(){t.linter()}),1e3)},saveModel:function(){localStorage.eventModel=JSON.stringify(this.jsonModel),this.snackbar=!0;var e={event:{alarm:{deviceId:this.deviceId,severity:"INFORMATIVE",priority:"LOW",name:this.selectedEvent,timestamp:(new Date).getTime(),variables:[this.jsonModel[this.deviceId][this.selectedEvent]]}}};this.$api.Sapi.post("devices/".concat(this.deviceId,"/events/alarms"),e)}}},f=(n(549),n(19)),component=Object(f.a)(m,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-form",{ref:"form",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[n("v-autocomplete",{attrs:{items:e.deviceEvents,label:"Event to send to platform",autowidth:"","auto-select-first":""},on:{change:e.eventChanged},model:{value:e.selectedEvent,callback:function(t){e.selectedEvent=t},expression:"selectedEvent"}}),e._v(" "),n("v-btn-toggle",[n("v-dialog",{attrs:{width:"500"},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on,o=t.attrs;return[n("v-btn",e._g(e._b({attrs:{text:""}},"v-btn",o,!1),r),[n("v-icon",[e._v("mdi-plus")])],1)]}}]),model:{value:e.logDialog,callback:function(t){e.logDialog=t},expression:"logDialog"}},[e._v(" "),n("v-card",[n("v-card-title",{staticClass:"headline"},[e._v(" Add new event ")]),e._v(" "),n("v-text-field",{model:{value:e.eventTextField,callback:function(t){e.eventTextField=t},expression:"eventTextField"}}),e._v(" "),n("v-card-actions",[n("v-spacer"),e._v(" "),n("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:e.saveEvent}},[e._v("\r\n                        Save\r\n                    ")]),e._v(" "),n("v-btn",{attrs:{color:"red",text:""},on:{click:function(t){e.logDialog=!1}}},[e._v("Close")])],1)],1)],1),e._v(" "),n("v-btn",{attrs:{text:"",disabled:e.disabledMirror},on:{click:e.mirrorMethod}},[n("v-icon",[e._v("mdi-cog")])],1),e._v(" "),n("v-btn",{attrs:{text:"",disabled:e.disabledModel},on:{click:e.modelformMethod}},[n("v-icon",[e._v(" mdi-grease-pencil")])],1)],1),e._v(" "),e.mirror?n("div",[n("codemirror",{ref:"codemirror",attrs:{options:e.cmOptions},on:{changes:e.linter,onLoad:e.linter},model:{value:e.jsonLocal[e.deviceId][e.selectedEvent].code,callback:function(t){e.$set(e.jsonLocal[e.deviceId][e.selectedEvent],"code",t)},expression:"jsonLocal[deviceId][selectedEvent].code"}}),e._v(" "),n("v-btn",{attrs:{text:"",disabled:e.disabled},on:{click:e.saveSchema}},[e._v("\r\n                Save Schema\r\n            ")])],1):e._e(),e._v(" "),e.modelform?n("div",[n("v-form",{model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[n("v-jsf",{attrs:{schema:e.localSchema,options:e.options},model:{value:e.jsonModel[e.deviceId][e.selectedEvent],callback:function(t){e.$set(e.jsonModel[e.deviceId],e.selectedEvent,t)},expression:"jsonModel[deviceId][selectedEvent]"}})],1)],1):e._e(),e._v(" "),n("v-btn",{attrs:{fab:"",fixed:"",bottom:"",right:"",color:"accent"},on:{click:e.saveModel}},[n("v-icon",[e._v(" mdi-send ")])],1)],1),e._v(" "),n("v-snackbar",{scopedSlots:e._u([{key:"action",fn:function(t){var r=t.attrs;return[n("v-btn",e._b({attrs:{color:"pink",text:""},on:{click:function(t){e.snackbar=!1}}},"v-btn",r,!1),[e._v("\r\n                Close\r\n            ")])]}}]),model:{value:e.snackbar,callback:function(t){e.snackbar=t},expression:"snackbar"}},[e._v("\r\n        "+e._s("Event save and sended to platform")+"\r\n\r\n        ")])],1)}),[],!1,null,"86a51826",null);t.default=component.exports},328:function(e,t,n){"use strict";n.r(t);n(193),n(30);var r=n(6),o=n(126),c=(n(0),{mixins:[o.a],props:{model:{type:Object,default:function(){return null}}},name:"maps",inject:{theme:{default:{isDark:!1}}},data:function(){return{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",zoom:2,btnSend:!0,center:[0,0],markerBol:!1,markers:[[]],logLat:"LatLng(0, 0)",id_device:this.$route.query.id,date:null,trip:{name:"",location:null,start:null,end:null},mapObj:null,snackbar:!1}},computed:{deviceId:function(){return this.$route.query.id}},methods:{mapReady:function(e){var t=this;this.mapObj=e,this.model["entity.location"]&&(this.markers[0][1]=this.model["entity.location"]._value._current.value.position.coordinates[0],this.markers[0][0]=this.model["entity.location"]._value._current.value.position.coordinates[1],this.$nextTick((function(){return t.mapObj.flyTo(t.markers[0],15,{duration:2})})),this.logLat="LatLng("+this.markers[0][0]+", "+this.markers[0][1]+")",this.markerBol=!0)},addMarker:function(e){var t=this;this.markers.splice(0,1,e.latlng),this.logLat=this.markers[0],console.log(e.latlng),this.markerBol=!0,this.$nextTick((function(){return t.mapObj.flyTo(t.markers[0],15,{duration:2})})),this.send(),this.snackbar=!0},send:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=e.$api.deviceMessageBuilder().withDataStreamVersion(""+(new Date).getTime()),r=e.$api.datapointsBuilder().withValue(JSON.stringify([e.markers[0].lng,e.markers[0].lat])),o=e.$api.datastreamBuilder().withId("entity.location"),n.withDataStream(o.withDatapoint(r)),n.withId(e.$route.query.id),t.next=8,n.create();case 8:t.sent,t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),console.error(t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})))()}}}),l=n(19),component=Object(l.a)(c,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"pa-0 ma-0"},[n("l-map",{staticStyle:{height:"calc(100vh - 140px)",width:"100%"},attrs:{zoom:e.zoom,center:e.center},on:{click:e.addMarker,ready:e.mapReady}},[n("l-tile-layer",{attrs:{url:e.url}}),e._v(" "),n("l-control",{attrs:{position:"bottomleft"}},[n("v-card",[e._v("\r\n                "+e._s(e.logLat)+"\r\n            ")])],1),e._v(" "),e.markerBol?n("div",e._l(e.markers,(function(marker){return n("l-marker",{key:marker.lat,attrs:{"lat-lng":marker}})})),1):e._e()],1),e._v(" "),n("v-snackbar",{scopedSlots:e._u([{key:"action",fn:function(t){var r=t.attrs;return[n("v-btn",e._b({attrs:{color:"pink",text:""},on:{click:function(t){e.snackbar=!1}}},"v-btn",r,!1),[e._v("\r\n            Close\r\n          ")])]}}]),model:{value:e.snackbar,callback:function(t){e.snackbar=t},expression:"snackbar"}},[e._v("\r\n        "+e._s("Location sended")+"\r\n  \r\n        ")])],1)}),[],!1,null,null,null);t.default=component.exports},506:function(e,t,n){"use strict";var r=n(285);n.n(r).a},507:function(e,t,n){(t=n(46)(!1)).push([e.i,".switch[data-v-cbb835ea]{flex:unset}",""]),e.exports=t},549:function(e,t,n){"use strict";var r=n(289);n.n(r).a},550:function(e,t,n){(t=n(46)(!1)).push([e.i,".autocomplete[data-v-86a51826]{width:80%}",""]),e.exports=t},551:function(e,t,n){"use strict";var r=n(290);n.n(r).a},552:function(e,t,n){(t=n(46)(!1)).push([e.i,".menu[data-v-7de97362],.mobile[data-v-7de97362]{display:none}@media only screen and (max-width:768px){.nav_item[data-v-7de97362],.tittle[data-v-7de97362]{display:none}.menu[data-v-7de97362],.mobile[data-v-7de97362]{display:block}}",""]),e.exports=t},572:function(e,t,n){"use strict";n.r(t);var r={components:{compemulador:n(322).default},layout:"vdefault"},o=n(19),component=Object(o.a)(r,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("compemulador")],1)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Compemulador:n(322).default})}}]);